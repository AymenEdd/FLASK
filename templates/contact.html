{% extends "base.html" %} 
{% block title %}Contactez-nous - Boutique en Ligne{% endblock %} 
{% block content %}
<!-- Section Héro -->
<style>
/* Keep all your existing styles... */
.hero-section {
  background: linear-gradient(135deg, #158cba 0%, #0f6b96 100%);
  min-height: 60vh;
  display: flex;
  align-items: center;
  position: relative;
  overflow: hidden;
  padding-top: 2rem;
  padding-bottom: 2rem;
}

.bubbles-container {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  z-index: 1;
  pointer-events: none;
}

.bubble {
  position: absolute;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(5px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  animation: float 6s ease-in-out infinite;
  opacity: 0;
}

@keyframes float {
  0% {
    transform: translateY(calc(100vh + 50px)) scale(0);
    opacity: 0;
  }
  10% { opacity: 1; }
  90% { opacity: 1; }
  100% {
    transform: translateY(-150px) scale(1);
    opacity: 0;
  }
}

.hero-content {
  position: relative;
  z-index: 20;
}

.bubble-sm { width: 25px; height: 25px; }
.bubble-md { width: 45px; height: 45px; }
.bubble-lg { width: 65px; height: 65px; }
.bubble-xl { width: 85px; height: 85px; }

.bubble-1 { left: 5%; animation-duration: 8s; }
.bubble-2 { left: 15%; animation-duration: 6s; animation-delay: -1s; }
.bubble-3 { left: 25%; animation-duration: 7s; animation-delay: -2s; }
.bubble-4 { left: 35%; animation-duration: 9s; animation-delay: -3s; }
.bubble-5 { left: 45%; animation-duration: 6s; animation-delay: -4s; }
.bubble-6 { left: 55%; animation-duration: 8s; animation-delay: -0.5s; }
.bubble-7 { left: 65%; animation-duration: 7s; animation-delay: -1.5s; }
.bubble-8 { left: 75%; animation-duration: 6s; animation-delay: -2.5s; }
.bubble-9 { left: 85%; animation-duration: 8s; animation-delay: -3.5s; }
.bubble-10 { left: 95%; animation-duration: 9s; animation-delay: -4.5s; }
.bubble-11 { left: 10%; animation-duration: 7s; animation-delay: -5s; }
.bubble-12 { left: 20%; animation-duration: 6s; animation-delay: -1.2s; }
.bubble-13 { left: 30%; animation-duration: 8s; animation-delay: -2.2s; }
.bubble-14 { left: 40%; animation-duration: 7s; animation-delay: -3.2s; }
.bubble-15 { left: 50%; animation-duration: 9s; animation-delay: -4.2s; }

.contact-icon {
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, #158cba, #0f6b96);
  color: white !important;
  border-radius: 50%;
  margin-right: 1rem;
  font-size: 1rem;
  box-shadow: 0 3px 10px rgba(21, 140, 186, 0.3);
}

.card {
  border: none;
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
  border-radius: 1rem;
}
</style>

<section class="hero-section text-white py-5">
  <div class="bubbles-container">
    <div class="bubble bubble-sm bubble-1"></div>
    <div class="bubble bubble-md bubble-2"></div>
    <div class="bubble bubble-lg bubble-3"></div>
    <div class="bubble bubble-sm bubble-4"></div>
    <div class="bubble bubble-xl bubble-5"></div>
    <div class="bubble bubble-md bubble-6"></div>
    <div class="bubble bubble-sm bubble-7"></div>
    <div class="bubble bubble-lg bubble-8"></div>
    <div class="bubble bubble-md bubble-9"></div>
    <div class="bubble bubble-sm bubble-10"></div>
    <div class="bubble bubble-lg bubble-11"></div>
    <div class="bubble bubble-md bubble-12"></div>
    <div class="bubble bubble-xl bubble-13"></div>
    <div class="bubble bubble-sm bubble-14"></div>
    <div class="bubble bubble-md bubble-15"></div>
  </div>

  <div class="container hero-content">
    <div class="row">
      <div class="col-12 text-center">
        <h1 class="display-4 fw-bold mt-5 mb-4 text-white">Contactez-nous</h1>
        <p class="lead">
          Nous serions ravis de vous entendre. Envoyez-nous un message et nous vous répondrons dès que possible.
        </p>
      </div>
    </div>
  </div>
</section>

<section class="py-5">
  <div class="container">
    <div class="row">
      <!-- Formulaire de contact -->
      <div class="col-lg-8 mb-5">
        <div class="card shadow">
          <div class="card-header bg-primary text-white">
            <h3 class="mb-0">
              <i class="fas fa-envelope"></i> Envoyez-nous un message
            </h3>
          </div>
          <div class="card-body">
            <!-- FIXED: Use form object with CSRF token and pre-fill user data -->
            <form method="POST" novalidate>
              {{ form.hidden_tag() }}
              
              <div class="row">
                <div class="col-md-6 mb-3">
                  {{ form.name.label(class="form-label") }}
                  {% if current_user.is_authenticated %}
                    {{ form.name(class="form-control" + (" is-invalid" if form.name.errors else ""), value=current_user.username) }}
                  {% else %}
                    {{ form.name(class="form-control" + (" is-invalid" if form.name.errors else "")) }}
                  {% endif %}
                  {% if form.name.errors %}
                    <div class="invalid-feedback">
                      {% for error in form.name.errors %}{{ error }}{% endfor %}
                    </div>
                  {% endif %}
                </div>
                <div class="col-md-6 mb-3">
                  {{ form.email.label(class="form-label") }}
                  {% if current_user.is_authenticated %}
                    {{ form.email(class="form-control" + (" is-invalid" if form.email.errors else ""), value=current_user.email) }}
                  {% else %}
                    {{ form.email(class="form-control" + (" is-invalid" if form.email.errors else "")) }}
                  {% endif %}
                  {% if form.email.errors %}
                    <div class="invalid-feedback">
                      {% for error in form.email.errors %}{{ error }}{% endfor %}
                    </div>
                  {% endif %}
                </div>
              </div>
              
              <div class="mb-3">
                {{ form.message.label(class="form-label") }}
                {{ form.message(class="form-control" + (" is-invalid" if form.message.errors else ""), rows="5") }}
                {% if form.message.errors %}
                  <div class="invalid-feedback">
                    {% for error in form.message.errors %}{{ error }}{% endfor %}
                  </div>
                {% endif %}
              </div>
              
              <div class="d-grid">
                {{ form.submit(class="btn btn-primary btn-lg") }}
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Informations de contact -->
      <div class="col-lg-4">
        <div class="card shadow mb-4">
          <div class="card-header bg-success text-white">
            <h4 class="mb-0">
              <i class="fas fa-info-circle"></i> Informations de contact
            </h4>
          </div>
          <div class="card-body">
            <div class="contact-item mb-4">
              <div class="d-flex align-items-center">
                <div class="contact-icon me-3">
                  <i class="fas fa-map-marker-alt"></i>
                </div>
                <div>
                  <h6 class="mb-1">Adresse</h6>
                  <p class="text-muted mb-0">
                    123 Rue du Commerce<br />
                    Quartier d'affaires<br />
                    New York, NY 10001
                  </p>
                </div>
              </div>
            </div>
            <div class="contact-item mb-4">
              <div class="d-flex align-items-center">
                <div class="contact-icon me-3">
                  <i class="fas fa-phone"></i>
                </div>
                <div>
                  <h6 class="mb-1">Téléphone</h6>
                  <p class="text-muted mb-0">+1 (555) 123-4567</p>
                </div>
              </div>
            </div>
            <div class="contact-item mb-4">
              <div class="d-flex align-items-center">
                <div class="contact-icon me-3">
                  <i class="fas fa-envelope"></i>
                </div>
                <div>
                  <h6 class="mb-1">Email</h6>
                  <p class="text-muted mb-0">info@store.com</p>
                </div>
              </div>
            </div>
            <div class="contact-item">
              <div class="d-flex align-items-center">
                <div class="contact-icon me-3">
                  <i class="fas fa-clock"></i>
                </div>
                <div>
                  <h6 class="mb-1">Horaires d'ouverture</h6>
                  <p class="text-muted mb-0">
                    Lundi - Vendredi : 9h00 - 18h00<br />
                    Samedi : 10h00 - 16h00<br />
                    Dimanche : Fermé
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const bubbles = document.querySelectorAll('.bubble');
  const heroSection = document.querySelector('.hero-section');
  
  function repelBubbles(mouseX, mouseY) {
    bubbles.forEach(bubble => {
      const rect = bubble.getBoundingClientRect();
      const bubbleCenterX = rect.left + rect.width / 2;
      const bubbleCenterY = rect.top + rect.height / 2;
      
      const distance = Math.sqrt(
        Math.pow(mouseX - bubbleCenterX, 2) + 
        Math.pow(mouseY - bubbleCenterY, 2)
      );
      
      const repelRadius = 100;
      
      if (distance < repelRadius) {
        const angle = Math.atan2(bubbleCenterY - mouseY, bubbleCenterX - mouseX);
        const force = (repelRadius - distance) / repelRadius;
        const moveDistance = force * 40;
        
        const moveX = Math.cos(angle) * moveDistance;
        const moveY = Math.sin(angle) * moveDistance;
        
        bubble.style.transform = `translate(${moveX}px, ${moveY}px) scale(${0.8 + force * 0.3})`;
      } else {
        bubble.style.transform = '';
      }
    });
  }
  
  if (!('ontouchstart' in window)) {
    heroSection.addEventListener('mousemove', function(e) {
      repelBubbles(e.clientX, e.clientY);
    });
    
    heroSection.addEventListener('mouseleave', function() {
      bubbles.forEach(bubble => {
        bubble.style.transform = '';
      });
    });
  }
  
  heroSection.addEventListener('touchmove', function(e) {
    const touch = e.touches[0];
    repelBubbles(touch.clientX, touch.clientY);
  });
  
  heroSection.addEventListener('touchend', function() {
    bubbles.forEach(bubble => {
      bubble.style.transform = '';
    });
  });
});
</script>
{% endblock %}